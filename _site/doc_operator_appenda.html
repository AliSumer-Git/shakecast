<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="troubleshootingshakecast_v3,  appendix, inventory, format, facility, group, user">
<title>User Inventory Format | ShakeCast Documentation</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="stylesheet" href="css/project.css">

<link rel="alternate" type="application/rss+xml" title="" href="feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html"><img src="images/usgs_sc_logo.png">&nbsp;<span class="projectTitle"> ShakeCast Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="news">News</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">ShakeCast Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/klin-usgs/ShakeCast" target="_blank">Github Repo</a></li>
                        
                        
                        
                        <li><a href="http://earthquake.usgs.gov/research/software/shakecast/" target="_blank">ShakeCast Web</a></li>
                        
                        
                        
                        <li><a href="ftp://ftpext.usgs.gov/pub/cr/co/Golden/ShakeCast" target="_blank">ShakeCast FTP</a></li>
                        
                        
                        
                        <li><a href="https://my.usgs.gov/confluence/display/ShakeCast/Home" target="_blank">ShakeCast Science Base</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Products<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="doc_introduction.html">ShakeCast V3</a></li>
                        
                        
                        
                        <li><a href="apidocs">ShakeCast V4 (pyCast)</a></li>
                        
                        
                        
                        <li><a href="index.html">ShakeCast Workbook</a></li>
                        
                        
                        
                        <li><a href="index.html">ShakeCast Lite</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<!-- Send feedback function -->
<script>
function SendLinkByMail(href) {
var subject= "ShakeCast Documentation feedback";
var body = "I have some feedback about the User Inventory Format page: ";
body += window.location.href;
body += "";
var uri = "mailto:shakecast-help@usgs.gov?subject=";
uri += encodeURIComponent(subject);
uri += "&body=";
uri += encodeURIComponent(body);
window.location.href = uri;
}
</script>

<li><a href="javascript:void(0)" onclick="SendLinkByMail()"><i class="fa fa-envelope-o"></i> Feedback</a></li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: './search.json',
                                searchResultTemplate: '<li><a href="{url}" title="User Inventory Format">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">ShakeCast Documentation 3.0</li>
    
    
    
        
    
    <li>
        <a href="#">Overview</a>
        <ul>
            
            
            
            <li><a href="index.html">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="doc_about.html">About the authors</a></li>
            
            
            
            
            
            
            <li><a href="doc_support.html">Support</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Installation</a>
        <ul>
            
            
            
            <li><a href="doc_requirements.html">System Requirements</a></li>
            
            
            
            
            
            
            <li><a href="doc_install_shakecast_on_windows.html">Install ShakeCast on Windows</a></li>
            
            
            
            
            
            
            <li><a href="doc_install_shakecast_on_aws.html">Install ShakeCast on AWS</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Release Notes</a>
        <ul>
            
            
            
            <li><a href="doc_release_notes_3.html">V3 Release notes</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">User Guide</a>
        <ul>
            
            
            
            <li><a href="doc_pages.html">User Guide</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Technical Guide</a>
        <ul>
            
            
            
            <li><a href="doc_operator_install.html">Installation</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_config.html">System Configuration</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_custom.html">Customization</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_admin.html">Administration</a></li>
            
            
            
            
            
            
            <li class="active"><a href="doc_operator_appenda.html">Append. Inventory Format</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_appendb.html">Append. Metadata Format</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_appendc.html">Append. Utility Scripts</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_appendd.html">Append. HAZUS MBT</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_appende.html">Append. MBT Fragility</a></li>
            
            
            
            
            
            
            <li><a href="doc_operator_appendf.html">Append. Template Keywords</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Troubleshooting</a>
        <ul>
            
            
            
            <li><a href="doc_v2_to_v3.html">V2 to V3</a></li>
            
            
            
            
            
            
            <li><a href="doc_faq.html">FAQ</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        
        <div class="post-header">
   <h1 class="post-title-main">User Inventory Format</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    
    <a target="_blank" href="https://github.com/klin-usgs/shakecast/blob/gh-pages//pages/doc//doc_operator_appenda.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    
    

  <p>Appendix A provides specifications on the format of the data files that must be supplied to customize the system to a user’s facility inventory, fragilities and their user and notification information. An example of each file is provided with the V3 ShakeCast distribution in a folder found in the ShakeCast database directory, default at “/usr/local/shakecast/sc/db” A text editor is sufficient for customizing these files, though users with substantial inventories may consider keeping a database or spreadsheet for this purpose. The suggested strategy is to maintain or export CSV files for each of the required input files described below, and then use the drag-and-drop functionality within the ShakeCast web interface to upload (or update) any of the files.</p>

<h2 id="facility-data">Facility Data</h2>

<p>The scope of facility data for ShakeCast V3 covers three main categories: 1) basic facility and associated simple fragility information; 2) probabilistic fragility information; and 3) supplemental feature information. Facility data can be prepared in the format of either Comma-Separated Values (CSV) or Extensible Markup Language (2003 Excel XML export format) to be imported into the ShakeCast database. Currently there are several import scripts for processing facility data of each category and to ensure backward compatibility with V2 facility data.  Specifically, the format and requirement for basic facility and associated fragility information are identical for both V2 and V3 systems.  Users can migrate from a V2 system to V3 using the same facility data file.</p>

<p>By default CSV fields are separated by commas; field values that include commas are protected by enclosing them in quotes, but these defaults can be modified if necessary.  The first record in the input file must contain column headers allowing processing scripts to interpret the rest of the records.  Each header field must specify a facility field, a facility metric field, or a group field.  The header fields are case-insensitive; facility_name and FACILITY_NAME are equivalent.  Fields can appear in any order.</p>

<p><strong>Facility Fields</strong></p>

<p>The following facility names are recognized.  These fields correspond to tables and columns in the ShakeCast database.  Please refer to the ShakeCast Database Description for a more detailed description of the structure of the ShakeCast Database.</p>

<p><strong>external_facility_id (Text(32), required always)</strong></p>

<p>This field identifies the facility.  It must be unique for a facility type but the same external_facility_id may be used for different types of facilities.</p>

<p><strong>facility_type (Text(10), required always)</strong></p>

<p>This field identifies the type of facility.  It must match one of the types in the facility_type table. Currently defined types are: BRIDGE, CAMPUS, CITY, COUNTY, DAM, DISTRICT, ENGINEERED, INDUSTRIAL, MULTIFAM, ROAD, SINGLEFAM, STRUCTURE, TANK, TUNNEL, UNKNOWN, and HAZUS building types.  Refer the HAZUS Damage Level document for the 128 HAZUS building types and code era.</p>

<p><strong>facility_name (Text(128), required for insert/replace)</strong></p>

<p>The value of this field is what the user sees.</p>

<p><strong>short_name (Text(10), optional)</strong></p>

<p>The value of this field is used by ShakeCast when a shorter version of the name is needed due to space limitations in the output.</p>

<p><strong>description (Text(255), optional)</strong></p>

<p>You can use this field to include a short description of the facility.</p>

<p><strong>lat (Float, required for insert/replace)</strong></p>

<p>Specifies the latitude of the facility in degrees and fractional degrees.</p>

<p><strong>lon (Float, required for insert/replace)</strong></p>

<p>Specifies the longitude of the facility in degrees and fractional degrees.</p>

<p><strong>Fragility Fields</strong></p>

<p>Each field beginning with METRIC: is taken to be a facility fragility specifier. The format of a fragility specifier is:</p>

<p><strong>METRIC:</strong> <em>metric-name</em> <strong>:</strong> <em>damage-level</em></p>

<p>where metric-name is a valid ShakeMap metric (MMI, PGV, PGA, PSA03, PSA10, or PSA30) and alert-level is a valid damage level (GREEN, YELLOW, ORANGE, or RED).  Examples of Facility Fragility column labels areMETRIC:MMI:REDandmetric:pga:yellow.</p>

<p>The metric-name values are defined by the ShakeMap system, and are generally not changed.  The above values are current as of summer 2013.  The damage-level values shown above are the default values shipped with ShakeCast.  These values are defined in your local ShakeCast database, and you may use the administration web interface to change those values and the color-names that refer to them.</p>

<p><strong>Attribute Fields</strong></p>

<p>A facility can have attributes associated with it.  These attributes can be used to group and filter facilities.</p>

<p>Each field beginning with ATTR:is taken to be a facility attribute specifier. The format of a facility attribute specifier is:</p>

<p><strong>ATTR:</strong> <em>attribute-name</em> <strong>:</strong> <em>attribute-value</em></p>

<p>where <em>attribute-name</em> is a string not more than 20 characters in length.</p>

<p>Examples of Facility Attribute column labels are <code class="highlighter-rouge">ATTR:COUNTY</code> and <code class="highlighter-rouge">ATTR:Construction</code>.  Attribute values can be any string up to 30 characters long.</p>

<p><strong>Example Facilities</strong></p>

<p><em>Example 1 – Point Facilities</em></p>

<p>Assume we have a file named <em>ca_cities.csv</em> containing California cities that we want to load into the ShakeCast database.  The file is in CSV format and includes the name of each city and the latitude/longitude of its city center or city hall.  Records in the file are of the form</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  Rancho Cucamonga,34.1233,-117.5794
  Pasadena,34.1561,-118.1318
</code></pre>
</div>

<p>The file is missing two required fields,external_facility_id and facility_type.  Since the city name is unique we can add a new column that is a copy of the name column and use that as the external_facility_id.  Another column containing the value CITY for each row is added for the facility_type.  You can either make these changes using a spreadsheet program or with a simple script written in a text processing language like Perl.</p>

<p>After making these modifications the records look like</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  CITY,Rancho Cucamonga,Rancho Cucamonga,34.1233,-117.5794
  CITY,Pasadena,Pasadena,34.1561,-118.1318
</code></pre>
</div>

<p>The input file also needs a header record; after adding one the input file looks like</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  FACILITY\_TYPE,EXTERNAL\_FACILITY\_ID,FACILITY\_NAME,LAT,LON
  CITY,Rancho Cucamonga,Rancho Cucamonga,34.1233,-117.5794
  CITY,Pasadena,Pasadena,34.1561,-118.1318
   ...
</code></pre>
</div>

<p>The facilities in this file can now be loaded into ShakeCast using the command</p>

<p>manage_facility.pl ca_cities.csv</p>

<p><em>Example 2 – Fragility Parameters</em></p>

<p>Building on the previous example, assume a simple model where Instrumental Intensity (MMI) above 7 corresponds to a high-level alert (RED), MMI between 5 and 7 corresponds to a medium-level alert (YELLOW), and MMI below 5 corresponds to a low alert level (GREEN).  The lower threshold of each range (1, 5, 7) is appended to every record in the input file and the header record is changed to reflect the added fields:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  FACILITY\_TYPE,EXTERNAL\_FACILITY\_ID,FACILITY\_NAME,LAT,LON, \
        METRIC:MMI:GREEN,METRIC:MMI:YELLOW,METRIC:MMI:RED
  CITY,Rancho Cucamonga,Rancho Cucamonga,34.1233,-117.5794,1,5,7
  CITY,Pasadena,Pasadena,34.1561,-118.1318,1,5,7
   ...
</code></pre>
</div>

<p><em>Example 3 – Multiple Attributes and Multiple Metrics</em></p>

<p>You can include multiple attributes, multiple metrics, or multiple attributes and multiple metrics for each row of an import file.  For example,</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  FACILITY\_TYPE,EXTERNAL\_FACILITY\_ID,ATTR:COUNTY, ATTR:SIZE,\
        METRIC:MMI:GREEN, METRIC:MMI:YELLOW, METRIC:MMI:RED
  CITY,Rancho Cucamonga,San Bernardino,Small,1,2,6
  CITY,Pasadena,os Angeles,Medium,1,2,6
</code></pre>
</div>

<p>This file would be loaded using the command</p>

<p><code class="highlighter-rouge">manage\_facility.pl --update city\_county.csv</code></p>

<p>The above example updates the existing city locations to associate them with a county attribute and a size attribute, and defines the green, yellow, and red shaking alert thresholds.</p>

<h2 id="probabilistic-facility-fragility-data">Probabilistic Facility Fragility Data</h2>

<p>ShakeCast V3 includes a generic processer for evaluating probabilities of exceedance of individual damage states and their likelihood as a combined set.  The probability density function is modeled as log-normal distribution.  To enable this optional function, users need to provide the mean (ALPHA) and the spread (BETA) value of a fragility curve for each potential damage state to be evaluated.</p>

<p>When preparing probability fragility data for ShakeCast import, the format requirements for facility data are applied to fragility data.  Specifically, the <strong>external_facility_id</strong> and <strong>facility_type</strong> fields of the fragility data file must match the entry in the facility data file if they are imported separately.  It is permitted to define more than one set of fragility curves targeting different aspects of facility performance.  This function is implemented with an additional facility attribute field called “ <strong>component</strong>.”  It is a user-defined field for describing facility-specific components to be modeled and evaluated for a given ground motion input.  The user needs to specify the designated component of the facility for each fragility curve set.  It is not required to define fragility curves for all potential damage states for a component.  This usually applies to modeling secondary components or general stress indicators.</p>

<p>The user should be aware that the assessment of probabilistic analysis is considered as a secondary analysis.  Results of the analysis will be stored on the ShakeCast system for inquiry by expert users but will not be sent out as the primary method for notification.  Among defined components, the ALPHA value of the “SYSTEM” component will be translated as simple fragility information to be used as part of the basic facility information.  This fragility information will be used for triggering notifications.</p>

<p><strong>Facility Fields</strong></p>

<p>The following facility names are recognized.  These fields correspond to tables and columns in the ShakeCast database.  Please refer to the ShakeCast Database Description for a more detailed description of the structure of the ShakeCast Database.</p>

<p><strong>external_facility_id (Text(32), required always)</strong></p>

<p>This field identifies the facility.  It must match the one specified in the basic facility data file if the information is entered separately.</p>

<p><strong>facility_type (Text(10), required always)</strong></p>

<p>This field identifies the type of facility.  It must match one of the types in the facility_type table.  It must match the one specified in the basic facility data file if the information is entered separately.</p>

<p><strong>class (Text(32), optional)</strong></p>

<p>The value of this field is used by ShakeCast to categorize components.</p>

<p><strong>component (Text(255), required always)</strong></p>

<p>The value of this field is used by ShakeCast to specify the target component of the defined fragility curve.</p>

<p><strong>Fragility Fields</strong></p>

<p>Each field beginning with METRIC: is taken to be a facility fragility specifier. The format of a fragility specifier is:</p>

<p><strong>METRIC:</strong> <em>metric-name</em><strong>:[ALPHA,BETA]:</strong><em>alert-level</em></p>

<p>where <em>metric-name</em> is a valid Shakemap metric (MMI, PGV, PGA, PSA03, PSA10, or PSA30) and <em>alert-level</em> is a valid alert level (GREEN, YELLOW, ORANGE, or RED).  Examples of Facility Fragility column labels are METRIC:MMI:ALPHA:RED and metric:pga:alpha:yellow.</p>

<p>The metric-name values are defined by the ShakeMap system, and are generally not changed.  The above values are current as of summer 2013.  The alert-level values shown above are the default values shipped with ShakeCast.  These values are defined in your local ShakeCast database, and you may use the administration web interface to change those values and the color-names that refer to them.</p>

<p><strong>Example Probabilistic Fragility Parameters</strong></p>

<p>Assume a simple probability model where Instrumental Intensity (MMI) with ALPHA of 8 and BETA of 0.6 corresponds to a high-level alert (RED), MMI with ALPHA of 7 and BETA of 0.6 corresponds to a medium-level alert (YELLOW), and MMI with ALPHA of 5 and BETA of 0.6 corresponds to a low-level alert (GREEN).  The input file and the header record is changed to reflect the added fields:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  FACILITY\_TYPE,EXTERNAL\_FACILITY\_ID, \
       METRIC:MMI:ALPHA:GREEN,METRIC:MMI:BETA:GREEN, \
        METRIC:MMI:ALPHA:YELLOW,METRIC:MMI:BETA:YELLOW, \
        METRIC:MMI:ALPHA:RED,METRIC:MMI:BETA:RED
  CITY,Rancho Cucamonga,Rancho Cucamonga,34.1233,-117.5794,5,0.6,7,0.6,8,0.6
  CITY,Pasadena,Pasadena,34.1561,-118.1318,5,0.6,7,0.6,8,0.6
   ...
</code></pre>
</div>

<h2 id="facility-feature-data">Facility Feature Data</h2>

<p>ShakeCast facility feature data allows users to define geometric footprints and rich content descriptions of a facility. The optional description field is specifically designed to store a custom HTML snippet to be displayed in the ShakeCast web interface. Content of this field will mask the data from the description field of basic facility information. The optional facility geometry field is designed to allow ShakeCast to take in account the extent of facility footprints when assessing ground shaking and damage state. The ShakeMap data grid is usually produced at a resolution of ~2x2 km, depending on the producer. This feature is directly applicable to facilities with linear feature such as roadways, aqueducts, etc.  For facilities with small footprints there is no added benefits to define complex geometry other than either point or rectangular type.</p>

<p>When preparing feature data for ShakeCast import, the format requirements for facility data are applied to fragility data. Specifically, the <strong>external_facility_id</strong> and <strong>facility_type</strong> fields of the feature data file must match the entry in the facility data file if they are imported separately. The user needs to specify the geometry type of the facility for the defined geometry coordinate set.  The user should be aware that the assessment of probabilistic analysis is considered as a secondary analysis.  In order to accommodate the unique nature HTML snippet for the facility description, the facility feature data needs to be in the format of XML with the CSV field definition translated to tagged format.</p>

<p><strong>Facility Fields</strong></p>

<p>The following facility names are recognized.  These fields correspond to tables and columns in the ShakeCast database.  Please refer to the ShakeCast Database Description for a more detailed description of the structure of the ShakeCast Database.</p>

<p><strong>external_facility_id (Text(32), required always)</strong></p>

<p>This field identifies the facility.  It must match the one specified in the basic facility data file if the information is entered separately.</p>

<p><strong>facility_type (Text(10), required always)</strong></p>

<p>This field identifies the type of facility.  It must match one of the types in the facility_type table.  It must match the one specified in the basic facility data file if the information is entered separately.</p>

<p><strong>geom_type (Text(32), required always)</strong></p>

<p>The value of this field is used by ShakeCast to handle the geometry coordinates from the <strong>geom</strong> field.  Currently defined types are: POINT, POLYLINE, POLYGON, RECTANGLE, and CIRCLE.</p>

<p><strong>geom (Text(mediumtext), required always)</strong></p>

<p>The value of this field is used by ShakeCast to specify the coordinates of the facility.   The format of this field is in (longitude,latitude) pairs separating by a white space.  The size limit of data is ~16MB.</p>

<p><strong>description (Text(mediumtext), required always)</strong></p>

<p>You can use this field to include a description of the facility.  The size limit of data is ~16MB.</p>

<p><strong>Example Probabilistic Fragility Parameters</strong></p>

<p>Assume a simple probability model where Instrumental Intensity (MMI) with ALPHA of 8 and BETA of 0.6 corresponds to a high-level alert (RED), MMI with ALPHA of 7 and BETA of 0.6 corresponds to a medium-level alert (YELLOW), and MMI with ALPHA of 5 and BETA of 0.6 corresponds to low-level alert (GREEN).  The input file and the header record is changed to reflect the added fields:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  FACILITY\_TYPE,EXTERNAL\_FACILITY\_ID, \
        METRIC:MMI:ALPHA:GREEN,METRIC:MMI:BETA:GREEN, \
        METRIC:MMI:ALPHA:YELLOW,METRIC:MMI:BETA:YELLOW, \
        METRIC:MMI:ALPHA:RED,METRIC:MMI:BETA:RED
  CITY,Rancho Cucamonga,Rancho Cucamonga,34.1233,-117.5794,5,0.6,7,0.6,8,0.6
  CITY,Pasadena,Pasadena,34.1561,-118.1318,5,0.6,7,0.6,8,0.6
   ...
</code></pre>
</div>

<h2 id="user-group-data">User Group Data</h2>

<p>ShakeCast GROUP is a new user classification introduced in V3, to provide area-specific processing and notifications for geographic regions defined by the users. For user notifications, membership in a GROUP is a primary channel of notifications for users with the same need of earthquake information.</p>

<p>In ShakeCast V3, GROUP polygon data is used as a geospatial filter for incoming earthquakes and ShakeMaps. This function enables ShakeCast users to define their own monitoring regions beyond the existing ShakeMap region boundaries.</p>

<p>User GROUP data is given in Apache config format.  Lines beginning with ‘#’ and empty lines will be ignored. Spaces at the beginning and the end of a line will also be ignored as well as tabulators.  If you need spaces at the end or the beginning of a value you can use apostrophe <strong>“</strong>. An option line starts with its name followed by a value. An ‘=’ sign is optional.  Some possible examples:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        user    max
        user  = max
        user            max
</code></pre>
</div>

<p>If there is more than one statement with the same name, it will create an array instead of a scalar.</p>

<p>Each group is defined as a <strong>block</strong> of options.  A <strong>block</strong> looks much like a block in the apache config format. It starts with &lt; <strong>blockname</strong> &gt; and ends with &lt;/ <strong>blockname</strong> &gt;. An example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;CI&gt;
        POLY         35.8000 -116.4000        \
                34.0815 -114.4717        \
                32.0000 -114.3333        \
                32.0000 -120.5000        \
                34.5000 -121.2500        \
                37.2167 -118.0167        \
                36.6847 -117.7930        \
                35.8000 -116.4000
        &lt;NOTIFICATION&gt;
                    NOTIFICATION\_TYPE        NEW\_EVENT
                    DELIVERY\_METHOD        EMAIL\_HTML
                EVENT\_TYPE                ALL
        &lt;/NOTIFICATION&gt;
        &lt;NOTIFICATION&gt;
                    NOTIFICATION\_TYPE        NEW\_PROD
                    DELIVERY\_METHOD        EMAIL\_HTML
                    PRODUCT\_TYPE                GRID\_XML
                EVENT\_TYPE                ALL
        &lt;/NOTIFICATION&gt;
 &lt;/CI&gt;
</code></pre>
</div>

<p>Each group is defined as a <strong>block</strong> of options.  A <strong>block</strong> looks much like a block in the well known apache config format. It starts with &lt; <strong>blockname</strong> &gt; and ends with &lt;/ <strong>blockname</strong> &gt;. The above example defines the user group <strong>CI</strong>.</p>

<p><strong>Group Tag Names</strong></p>

<p>The following group tag names are recognized.  These fields correspond to tables and columns in the ShakeCast database.  Please refer to the ShakeCast Database Description for a more detailed description of the structure of the ShakeCast Database.</p>

<p><strong>poly (float pairs, required always)</strong></p>

<p>This field identifies the boundaries of the group geometry.  It must contain at least three anchor points in order to define a polygon.  The total number of anchor points should limit to less than 100, otherwise the administration interface may not be able to display the entire polygon during editing.  The manage_profile.pl will however process the polygon definition.</p>

<p><strong>notification (Text(32), optional)</strong></p>

<p>One notification block represents one notification request associated with the group and applies to all facilities within the group polygon.  Multiple notification blocks for a group are permitted.</p>

<p><strong>facility_type (Text, optional)</strong></p>

<p>One notification block represents facility types to be associated with the group and applies to all facilities of the specified types within the group polygon.  Multiple type specifications must be separated by white spaces.</p>

<p><strong>description (Text(255), optional)</strong></p>

<p>One description block includes a simple description of the group.</p>

<p><strong>Notification Tag Names</strong></p>

<p>Each notification block defines one notification request.  Tag names are corresponding to the field names of the table “notification_request.”  Required tags for a notification block include NOTIFICATION_TYPE, DELIVERY_METHOD, and EVENT_TYPE.  Valid notification types are CAN_EVENT, NEW_EVENT, UPD_EVENT, SHAKING, NEW_PROD, and DAMAGE.</p>

<p><strong>can_event</strong></p>

<p>This notification request is triggered when an event is cancelled by the seismic network in which the event was located and removed from the USGS web site.  Require EVENT_TYPE and DELIVERY_METHOD tags.</p>

<p><strong>new_event</strong></p>

<p>This notification request is triggered when an event is located by a seismic network.  A ShakeMap may or may not be produced for the earthquake depending on triggering criteria defined by the ShakeMap producers.  Require EVENT_TYPE and DELIVERY_METHOD tags.</p>

<p><strong>upd_event</strong></p>

<p>This notification request is triggered when the source parameters of an event is updated with a new version by the seismic network.  New versions of ShakeMaps for the event may or may not coincide with an updated event.  Require EVENT_TYPE and DELIVERY_METHOD tags.</p>

<p><strong>new_prod</strong></p>

<p>This notification request is triggered when a specified ShakeMap product of an event is available on the USGS web site.  Require EVENT_TYPE,DELIVERY_METHOD, and PRODUCT tags.</p>

<p><strong>shaking</strong></p>

<p>This notification request is triggered when the ground shaking parameter at the location of the facility exceeds the preset value.  Require EVENT_TYPE,DELIVERY_METHOD, METRIC, and LIMIT_VALUE tags.</p>

<p><strong>alert-level</strong></p>

<p>This notification request is triggered when the ground shaking parameter at the location of the facility falls between the high and low values of facility fragility settings.  Require EVENT_TYPE,DELIVERY_METHOD, and ALERT_LEVEL tags.</p>

<h2 id="user-data">User Data</h2>

<p>The scope of user data for ShakeCast V3 covers three user categories: 1) regular user; 2) group user; and 3) administrative user.  Besides the additional group user type, there is little change to the requirements of user data and they can be prepared in the CSV format to be imported into the ShakeCast database.</p>

<p>Similar to facility CSV data, the first record of user data file must contain column headers.  These headers tell manage_user.pl how to interpret the rest of the records.  Each header field must specify a user name field and a user type field.  The header fields are case-insensitive; username and USERNAME are equivalent.  Fields can appear in any order.</p>

<p><strong>User Fields</strong></p>

<p>The following facility names are recognized.  These fields correspond to tables and columns in the ShakeCast database.  Please refer to the ShakeCast Database Description for a more detailed description of the structure of the ShakeCast Database.</p>

<p><strong>username (Text(32), required always)</strong></p>

<p>This field identifies the user.  It must be unique for a user type.</p>

<p><strong>user_type (Text(10), required always)</strong></p>

<p>This field identifies the type of use.  It must match one of the types in the user_type table. Currently defined types are: ADMIN, USER, and SYSTEM.</p>

<p><strong>full_name (Text(32), optional)</strong></p>

<p>The value of this field is the user’s full name.</p>

<p><strong>email_address (Text(255), optional)</strong></p>

<p>The value of this field is the user’s email address for receiving communication from the ShakeCast system.</p>

<p><strong>password (Text(64), optional)</strong></p>

<p>The value of this field is used by ShakeCast to generate password for accessing the ShakeCast interface and the web site if password protected.  Internally the password is saved inside the database using a cryptographic hash function SHA-256.</p>

<p><strong>phone_number (Text(32), optional)</strong></p>

<p>You can use this field to include a user’s phone number.</p>

<p><strong>Delivery Method Fields</strong></p>

<p>Each field beginning with DELIVERY: is taken to be a delivery method specifier. The format of a delivery method specifier is:</p>

<p><strong>DELIVERY:</strong> <em>delivery-method</em></p>

<p>where <em>delivery-method</em> is a valid message format (PAGER, EMAIL_HTML, or EMAIL_TEXT).  Examples of Delivery Method column labels are DELIVERY:EMAIL_HTML and delivery:email_html.</p>

<p>The message format values are defined by the ShakeCast system, and are generally not changed.  The alert-level values shown above are the default values shipped with ShakeCast.  These values are defined in your local ShakeCast database, and you may use the administration web interface to change those values and the color-names that refer to them.</p>

<p><strong>Group Fields</strong></p>

<p>A user can have notification requests replicated from an existing group.  Each field beginning with GROUP: is taken to be a group specifier.  The format of a profile specifier is:</p>

<p><strong>GROUP:</strong> <em>group-name[:goup-name…]</em></p>

<p>where <em>group-name</em> is a valid group name.</p>

<p><strong>User Fields</strong></p>

<p>A user can have notification requests replicated from an existing user.  Each field beginning with USER: is taken to be a user specifier.  The format of a user specifier is:</p>

<p><strong>USER:</strong> <em>shakecast-user</em></p>

<p>where <em>shakecast-user</em> is a valid user id.  In V3, use of this option is discouraged.</p>

<p><strong>Example Users</strong>  <strong>File</strong></p>

<p>Assume we have a file named <em>test_user.csv</em> containing users that we want to load into the ShakeCast database.  The file is in CSV format and includes the name of each user, user delivery method and group association.  The input file with the header record looks like</p>

<div class="highlighter-rouge"><pre class="highlight"><code>USER\_TYPE,USERNAME,PASSWORD,FULL\_NAME,EMAIL\_ADDRESS,PHONE\_NUMBER,DELIVERY:PAGER,DELIVERY:EMAIL\_HTML,GROUP:GLOBAL
USER,test\_user,sc4all,Test User,testuser@usgs.gov,(123)456-7890, testuser@usgs.gov, testuser@usgs.gov,GLOBAL
   ...
</code></pre>
</div>

<h2 id="plain-text-product-template">Plain-Text Product Template</h2>

<p>ShakeCast V3 uses the same template engine (the Perl Template Toolkit) as V2 to generate plain-text products, such as csv, xml, and kml, etc. only available on the local ShakeCast system.  A template also defined as a ShakeCast product can be included as an attachment in the ShakeCast notification to be delivered to the users directly.  Please see the Template Manual manpage for the complete reference which goes into much greater details about the features and use of the Template Toolkit.</p>

<p>This section covers a brief summary of the template directives.  ShakeCast specific identifiers include exposure, item, and type.  Facility specific identifiers include name, latitude, longitude, alert_level, MMI, PGA, PGV, PSA03, PSA10, and PSA30.</p>

<p><strong>GET</strong></p>

<p>Evaluate and print a variable or value.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [%   GET variable %]
    [%       variable %]
    [%       hash.key %]
    [%         list.n %]
    [%     code(args) %]
    [% obj.meth(args) %]
    [%  "value: $var" %]
</code></pre>
</div>

<p><strong>CALL</strong></p>

<p>As per GET but without printing result (e.g. call code)</p>

<div class="highlighter-rouge"><pre class="highlight"><code>[%  CALL variable %]
</code></pre>
</div>

<p><strong>SET</strong></p>

<p>Assign a values to variables.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% SET variable = value %]    # 'SET' also optional
    [%     variable = other\_variable
           variable = 'literal text @ $100'
           variable = "interpolated text: $var"
           list     = [val, val, val, val, ...]
           list     = [val..val]
           hash     = { var =&gt; val, var =&gt; val, ... }
    %]
</code></pre>
</div>

<p><strong>DEFAULT</strong></p>

<p>Like SET above, but variables are only set if currently unset (i.e. have no true value).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% DEFAULT variable = value %]
</code></pre>
</div>

<p><strong>INSERT</strong></p>

<p>Insert a file without any processing performed on the contents.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% INSERT legalese.txt %]
</code></pre>
</div>

<p><strong>INCLUDE</strong></p>

<p>Process another template file or block and include the output. Variables are localised.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% INCLUDE template %]
    [% INCLUDE template  var = val, ... %]
</code></pre>
</div>

<p><strong>PROCESS</strong></p>

<p>As INCLUDE above, but without localising variables.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% PROCESS template %]
    [% PROCESS template  var = val, ... %]
</code></pre>
</div>

<p><strong>WRAPPER</strong></p>

<p>Process the enclosed block WRAPPER … END block then INCLUDE the named template, passing the block output in the ‘content’ variable.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% WRAPPER template %]
       content...
    [% END %]
</code></pre>
</div>

<p><strong>BLOCK</strong></p>

<p>Define a named template block for subsequent INCLUDE, PROCESS, etc.,</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% BLOCK template %]
       content
    [% END %]
</code></pre>
</div>

<p><strong>FOREACH</strong></p>

<p>Repeat the enclosed FOREACH … END block for each value in the list.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% FOREACH variable = [val, val, val] %]    # either
    [% FOREACH variable = list %]                 # or
    [% FOREACH list %]                            # or
       content...
       [% variable %]
    [% END %]
</code></pre>
</div>

<p><strong>WHILE</strong></p>

<p>Enclosed WHILE … END block is processed while condition is true.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% WHILE condition %]
       content
    [% END %]
</code></pre>
</div>

<p><strong>IF / UNLESS / ELSIF / ELSE</strong></p>

<p>Enclosed block is processed if the condition is true / false.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% IF condition %]
       content
    [% ELSIF condition %]
         content
    [% ELSE %]
         content
    [% END %]
    [% UNLESS condition %]
       content
    [% # ELSIF/ELSE as per IF, above %]
       content
    [% END %]
</code></pre>
</div>

<p><strong>SWITCH / CASE</strong></p>

<p>Multi-way switch/case statement.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% SWITCH variable %]
    [% CASE val1 %]
       content
    [% CASE [val2, val3] %]
       content
    [% CASE %]         # or [% CASE DEFAULT %]
       content
    [% END %]
</code></pre>
</div>

<p><strong>MACRO</strong></p>

<p>Define a named macro.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% MACRO name &lt;directive&gt; %]
    [% MACRO name(arg1, arg2) &lt;directive&gt; %]
    ...
    [% name %]
    [% name(val1, val2) %]
</code></pre>
</div>

<p><strong>FILTER</strong></p>

<p>Process enclosed FILTER … END block then pipe through a filter.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% FILTER name %]                       # either
    [% FILTER name( params ) %]             # or
    [% FILTER alias = name( params ) %]     # or
       content
    [% END %]
</code></pre>
</div>

<p><strong>USE</strong></p>

<p>Load a “plugin” module, or any regular Perl module if LOAD_PERL option is set.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% USE name %]                          # either
    [% USE name( params ) %]                # or
    [% USE var = name( params ) %]          # or
    ...
    [% name.method %]
    [% var.method %]
</code></pre>
</div>

<p><strong>PERL / RAWPERL</strong></p>

<p>Evaluate enclosed blocks as Perl code (requires EVAL_PERL option to be set).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% PERL %]
         # perl code goes here
         $stash-&gt;set('foo', 10);
         print "set 'foo' to ", $stash-&gt;get('foo'), "\n";
         print $context-&gt;include('footer', { var =&gt; $val });
    [% END %]
    [% RAWPERL %]
       # raw perl code goes here, no magic but fast.
       $output .= 'some output';
    [% END %]
</code></pre>
</div>

<p><strong>TRY / THROW / CATCH / FINAL</strong></p>

<p>Exception handling.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% TRY %]
         content
       [% THROW type info %]
    [% CATCH type %]
         catch content
       [% error.type %] [% error.info %]
    [% CATCH %] # or [% CATCH DEFAULT %]
         content
    [% FINAL %]
       this block is always processed
    [% END %]
</code></pre>
</div>

<p><strong>NEXT</strong></p>

<p>Jump straight to the next item in a FOREACH/WHILE loop.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>`[% NEXT %]`
</code></pre>
</div>

<p><strong>LAST</strong></p>

<p>Break out of FOREACH/WHILE loop.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>`[% LAST %]`
</code></pre>
</div>

<p><strong>RETURN</strong></p>

<p>Stop processing current template and return to including templates.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>`[% RETURN %]`
</code></pre>
</div>

<p><strong>STOP</strong></p>

<p>Stop processing all templates and return to caller.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>`[% STOP %]`
</code></pre>
</div>

<p><strong>TAGS</strong></p>

<p>Define new tag style or characters (default: [% %]).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% TAGS html %]
    [% TAGS &lt;!-- --&gt; %]
</code></pre>
</div>

<p><strong>COMMENTS</strong></p>

<p>Ignored and deleted.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    [% # this is a comment to the end of line
       foo = 'bar'
    %]
    [%# placing the '#' immediately inside the directive
        tag comments out the entire directive
%]
</code></pre>
</div>

<p><strong>Example Exposure Template</strong></p>

<p>Assume we have a file named <em>exposure_csv.tt</em> containing template directives that we want to generate a local ShakeCast product “<em>exposure.csv</em>.”  The template file first includes a static header is in CSV format.  The main body of the template file contains a directive that loops through exposure facilities and outputs selected fields, including basic facility information, shaking estimates and damage estimate.  The template file with the header record looks like</p>

<div class="highlighter-rouge"><pre class="highlight"><code>FACILITY\_TYPE,FACILITY\_ID,FACILITY\_NAME,DIST,LATITUDE,LONGITUDE,\
DAMAGE\_LEVEL,MMI,PGA,PGV,PSA03,PSA10,PSA30,STDPGA,SVEL
[% FOREACH exposure = shakecast.exposure %]
[%- FOREACH item = exposure.item -%]
[% exposure.type %],"[% item.external\_facility\_id %]",\
"[% item.facility\_name %]",[% item.DIST %],[% item.latitude %],\
[% item.longitude %],[% item.damage\_level %],[% item.MMI %],\
[% item.PGA %],[% item.PGV %],[% item.PSA03 %],[% item.PSA10 %],\
[% item.PSA30 %],[% item.STDPGA %],[% item.SVEL %]
[%- END -%]
[% END %]
</code></pre>
</div>

<p>and the output exposure.csv looks like</p>

<div class="highlighter-rouge"><pre class="highlight"><code>FACILITY\_TYPE,FACILITY\_ID,FACILITY\_NAME,DIST,LATITUDE,LONGITUDE,DAMAGE\_LEVEL,MMI,PGA,PGV,PSA03,PSA10,PSA30,STDPGA,SVEL
CITY,"101614","Warm Springs, NV (pop. 1K)",111.15,38.2,-116.4,GREEN,1,0.02,0.01,0.01,0,0,,784
CITY,"100241","Caliente, NV (pop. 1.1K)",86.76,37.615,-114.511,GREEN,1.08,0.02,0.01,0.02,0,0,,483.25
CITY,"100019","Alamo, NV (pop. &lt; 1K)",32.61,37.365,-115.164,GREEN,3.08,0.15,0.04,0.15,0.02,0,,460.5
   ...
</code></pre>
</div>

<h2 id="portable-document-format-pdf-product-template">Portable Document Format (PDF) Product Template</h2>

<p>ShakeCast V3 introduces a new template engine to generate reports with flexible layouts in PDF format.  Each PDF product template consists of one base PDF template and one configuration (or directive) file.  Earthquake-specific PDF output will be saved into the earthquake-specific data directory under the same name as the PDF template.  A template also defined as a ShakeCast product can be included as an attachment in the ShakeCast notification to be delivered to the users directly.</p>

<p>PDF directive file must be prepared in XML format.  The PDF template engine runs as a middleware to translate directives to PDF layout commands.  Thus although there are no ShakeCast-specific requirements, users need to refer to the Adobe PDF specifications regarding text, fonts, graphics, and other information needed to display it.</p>

<p>Each styled-content is defined as a <strong>block</strong> of options.  A <strong>block</strong> looks much like a block in the well-known XML tag. It starts with &lt; <strong>blockname</strong> &gt; and ends with &lt;/ <strong>blockname</strong> &gt;. An example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        &lt;image&gt;
                &lt;path&gt;screenshot.jpg&lt;/path&gt;
                &lt;type&gt;jpeg&lt;/type&gt;
                &lt;x&gt;0&lt;/x&gt;
                &lt;y&gt;0&lt;/y&gt;
                &lt;w&gt;8.0&lt;/w&gt;
                &lt;h&gt;4.0&lt;/h&gt;
                &lt;unit&gt;inch&lt;/unit&gt;
                &lt;align&gt;center&lt;/align&gt;
                &lt;valign&gt;center&lt;/valign&gt;
                &lt;pad&gt;0.1&lt;/pad&gt;
        &lt;/image&gt;
</code></pre>
</div>

<p>defines the content and layout of an image.</p>

<p>The following PDF tag names are recognized.  These fields correspond to specific PDF format specification.</p>

<p><strong>page</strong></p>

<p>Insert a new page in the PDF document. The example below inserts a new page in the PDF document and imports a DYFI pdf into the page.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        &lt;page&gt;
                &lt;pdf&gt;
                        &lt;path&gt;eq\_product/[EVID]/\*\_ciim.pdf&lt;/path&gt;
                &lt;/pdf&gt;
        &lt;/page&gt;
</code></pre>
</div>

<p><strong>block</strong></p>

<p>Insert a block of content inside a page at the specified location.  The example below paints a gray rectangle with black borders and inserts a paragraph of text inside the block.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        &lt;block fillcolor="lightgrey" strokecolor="black" &gt;
                &lt;action&gt;rect&lt;/action&gt;
                &lt;style&gt;fillstroke&lt;/style&gt;
                &lt;x&gt;0.1&lt;/x&gt;
                &lt;y&gt;8.3&lt;/y&gt;
                &lt;w&gt;8.3&lt;/w&gt;
                &lt;h&gt;0.7&lt;/h&gt;
                &lt;unit&gt;inch&lt;/unit&gt;
                &lt;text&gt;
                        &lt;string size="12" &gt;These results are from an automated system and users should consider the preliminary nature of this information when making decisions relating to public safety. ShakeCast results are often updated as additional or more accurate earthquake information is reported or derived.&lt;/string&gt;
                        &lt;x&gt;0.15&lt;/x&gt;
                        &lt;y&gt;8.8&lt;/y&gt;
                        &lt;w&gt;8.2&lt;/w&gt;
                        &lt;h&gt;1.0&lt;/h&gt;
                        &lt;lead&gt;10&lt;/lead&gt;
                        &lt;align&gt;justify&lt;/align&gt;
                        &lt;unit&gt;inch&lt;/unit&gt;
                &lt;/text&gt;
        &lt;/block&gt;
</code></pre>
</div>

<p><strong>text</strong></p>

<p>Insert a text block at the specified location.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        &lt;text&gt;
                &lt;string size="22" type="Times-Bold" &gt;Magnitude [MAG] - [LOCSTRING]&lt;/string&gt;
                &lt;x&gt;0.1&lt;/x&gt;
                &lt;y&gt;9.9&lt;/y&gt;
                &lt;w&gt;7.0&lt;/w&gt;
                &lt;h&gt;0.5&lt;/h&gt;
                &lt;align&gt;justify&lt;/align&gt;
                &lt;unit&gt;inch&lt;/unit&gt;
        &lt;/text&gt;
</code></pre>
</div>

<p><strong>image</strong></p>

<p>Insert an image from an external file at the specified location with respect to the event directory.  If width (w) and height (h) are specified, the image will be resized to the specified dimensions.  Acceptable image types are jpeg, tiff, png, gif, and gd.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        &lt;image&gt;
                &lt;path&gt;screenshot.jpg&lt;/path&gt;
                &lt;type&gt;jpeg&lt;/type&gt;
                &lt;x&gt;0&lt;/x&gt;
                &lt;y&gt;0&lt;/y&gt;
                &lt;w&gt;8.0&lt;/w&gt;
                &lt;h&gt;4.0&lt;/h&gt;
                &lt;unit&gt;inch&lt;/unit&gt;
                &lt;align&gt;center&lt;/align&gt;
                &lt;valign&gt;center&lt;/valign&gt;
                &lt;pad&gt;0.1&lt;/pad&gt;
        &lt;/image&gt;
</code></pre>
</div>

<p><strong>table</strong></p>

<p>Insert a table from an external CSV file to the current page. The example below inserts a table to the specified location of the current page.  New pages will be inserted if the length of the table exceeds the page height.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        &lt;table&gt;
                &lt;list&gt;exposure.csv&lt;/list&gt;
                &lt;type&gt;CITY USGS&lt;/type&gt;
                &lt;x&gt;0.1&lt;/x&gt;
                &lt;w&gt;8.3&lt;/w&gt;
                &lt;start\_y&gt;3.9&lt;/start\_y&gt;
                &lt;next\_y&gt;10.75&lt;/next\_y&gt;
                &lt;start\_h&gt;3.0&lt;/start\_h&gt;
                &lt;next\_h&gt;10.0&lt;/next\_h&gt;
                &lt;font\_size&gt;8&lt;/font\_size&gt;
                &lt;padding&gt;2&lt;/padding&gt;
                &lt;padding\_right&gt;2&lt;/padding\_right&gt;
                &lt;background\_color\_even&gt;snow&lt;/background\_color\_even&gt;
                &lt;background\_color\_odd&gt;wheat&lt;/background\_color\_odd&gt;
                &lt;unit&gt;inch&lt;/unit&gt;
                &lt;border&gt;0.25&lt;/border&gt;
                &lt;border\_color&gt;snow&lt;/border\_color&gt;
        &lt;field&gt;FACILITY\_TYPE,FACILITY\_ID,FACILITY\_NAME,DIST,DAMAGE\_LEVEL,MMI,PGA,PGV,PSA03,PSA10,PSA30,SDPGA,SVEL&lt;/field&gt;
        &lt;/table&gt;
</code></pre>
</div>



<div class="tags">
    
    <b>Tags: </b>
    
    
    
    <a href="tag_troubleshooting" class="btn btn-default navbar-btn cursorNorm" role="button">troubleshooting</a>
    
    
    
    <a href="tag_shakecast_v3" class="btn btn-default navbar-btn cursorNorm" role="button">shakecast_v3</a>
    
    
    
</div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2016 U.S. Geological Survey. All rights reserved. <br />
<p>Page last updated:</span> July 3, 2016<br/> Site last generated: Jul 14, 2016 <br />
<p><img src="images/usgs.png" alt="USGS logo"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
    <script>
    jQuery(function ($) {
        $('.post-content').annotator()
                .annotator('setupPlugins', {tokenUrl: 'http://example.com/api/token'})
    });
    </script>
</body>
</html>